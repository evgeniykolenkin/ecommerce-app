{"mappings":"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","sources":["src/scripts/controller.js"],"sourcesContent":["class Controller {\r\n  constructor() {\r\n    this.model = new Model();\r\n    this.view = new View();\r\n  }\r\n\r\n  initShop() {\r\n    this.view.shop.addEventListener(\"click\", () => {\r\n      this.increment(event, \".item\", \"plus\");\r\n    });\r\n    this.view.shop.addEventListener(\"click\", () => {\r\n      this.decrement(event, \".item\", \"minus\");\r\n    });\r\n    this.view.generateShop(this.model.shopItemsData, this.model.basket);\r\n    this.calculation();\r\n  }\r\n\r\n  initCart() {\r\n    this.view.shopingCart.addEventListener(\"click\", () => {\r\n      this.increment(event, \".cart__item\", \"plus\");\r\n    });\r\n    this.view.shopingCart.addEventListener(\"click\", () => {\r\n      this.decrement(event, \".cart__item\", \"minus\");\r\n    });\r\n    this.view.shopingCart.addEventListener(\"click\", () => {\r\n      this.deleteCard(event, \".cart__item\", \"cross\");\r\n    });\r\n    this.view.label.addEventListener(\"click\", () => {\r\n      this.clearCart(event, \"clear\");\r\n    });\r\n    this.view.generateCartItems(this.model.basket, this.model.shopItemsData);\r\n    this.calculation();\r\n    this.getTotal();\r\n  }\r\n\r\n  increment(e, parentClass, actionName) {\r\n    const parentNode = e.target.closest(parentClass);\r\n    const id = parentNode.id;\r\n    const search = this.model.basket.find((item) => item.id === id);\r\n    if (e.target.dataset.action === actionName) {\r\n      if (search === undefined) {\r\n        this.model.basket.push({\r\n          id,\r\n          amount: 1,\r\n        });\r\n        this.model.setLocalStorage();\r\n        this.update(id);\r\n      } else {\r\n        search.amount += 1;\r\n        this.update(id);\r\n        this.model.setLocalStorage();\r\n      }\r\n    }\r\n  }\r\n\r\n  decrement(e, parentClass, actionName) {\r\n    const parentNode = e.target.closest(parentClass);\r\n    const id = parentNode.id;\r\n    const search = this.model.basket.find((item) => item.id === id);\r\n    if (e.target.dataset.action === actionName) {\r\n      if (search === undefined) {\r\n        return;\r\n      } else if (search.amount > 0) {\r\n        search.amount -= 1;\r\n        this.update(id);\r\n        this.model.basket = this.model.basket.filter(\r\n          (item) => item.amount !== 0\r\n        );\r\n        this.model.setLocalStorage();\r\n      }\r\n    }\r\n  }\r\n\r\n  deleteCard(e, parentClass, actioName) {\r\n    const parentNode = e.target.closest(parentClass);\r\n    const id = parentNode.id;\r\n    if (e.target.dataset.action === actioName) {\r\n      this.model.basket = this.model.basket.filter((item) => item.id !== id);\r\n    }\r\n    this.view.generateCartItems(this.model.basket, this.model.shopItemsData);\r\n    this.getTotal();\r\n    this.calculation();\r\n    this.model.setLocalStorage();\r\n  }\r\n\r\n  clearCart(e, actionName) {\r\n    if (e.target.dataset.action === actionName) {\r\n      this.model.basket = [];\r\n      this.view.generateCartItems(this.model.basket, this.model.shopItemsData);\r\n      this.calculation();\r\n      this.model.setLocalStorage();\r\n    }\r\n  }\r\n\r\n  getTotal() {\r\n    if (this.model.basket.length !== 0) {\r\n      const total = this.model.basket\r\n        .map((item) => {\r\n          const { id, amount } = item;\r\n          const search =\r\n            this.model.shopItemsData.find((shopItem) => shopItem.id === id) ||\r\n            [];\r\n          return amount * search.price;\r\n        })\r\n        .reduce((item, sum) => (sum += item), 0);\r\n      this.view.label.innerHTML = `\r\n          <h2>Общяя стоимость: ${total}$</h2>\r\n          <button data-action=\"check\" class=\"checkout\">Оформить</button>\r\n          <button data-action=\"clear\" class=\"clear__all\">Очистить корзину</button>\r\n        `;\r\n    } else {\r\n      return;\r\n    }\r\n  }\r\n\r\n  update(id) {\r\n    const search = this.model.basket.find((item) => item.id === id);\r\n    const item = document.getElementById(id);\r\n    const quantity = item.querySelector(\".quantity\");\r\n    quantity.innerHTML = search.amount;\r\n    this.calculation();\r\n  }\r\n\r\n  calculation() {\r\n    this.view.cartIcon.innerHTML = this.model.basket\r\n      .map((item) => item.amount)\r\n      .reduce((amount, sum) => (sum += amount), 0);\r\n  }\r\n}\r\n"],"names":[],"version":3,"file":"index.2dd5c390.js.map","sourceRoot":"/__parcel_source_root/"}